@model Pizza.Models.Enitities.Deal
@{
    ViewBag.Title = "Add To Cart";
}
@{
    List<SelectListItem> listItems = new List<SelectListItem>();

    listItems.Add(new SelectListItem
         {
             Text = "Thin Crust",
             Value = "1"
         });
    listItems.Add(new SelectListItem
         {
             Text = "Hand Tossed",
             Value = "2",
             
         });
    listItems.Add(new SelectListItem
         {
             Text = "Deep Dish",
             Value = "3"
         });
}
<div class="justify-content-center ftco-animate mt-5  heading-section">
    <h1 style="text-align:center;" id="name"> @Model.DealName </h1>
    <p class="flip"><span class="deg1"></span><span class="deg2"></span><span class="deg3"></span></p>
</div>

<section class="ftco-menu">
    <div class="container-fluid">
        <div class="row d-md-flex">
            <div class="col-lg-4 ftco-animate img f-menu-img mb-5 mb-md-0 justify-content-center" style="padding:25px;">
                <img style="height:200px; width:200px;" src="~/Content/images/@Model.DealImage" /> <p style="visibility:hidden;" id="img">@Model.DealImage</p><p style="visibility:hidden;" id="id"> @Model.DealID </p>
            </div>
            <div class="col-lg-8 ftco-animate p-md-5 fadeInUp ftco-animated">
                <div class="row">
                    <div class="col-md-12 nav-link-wrap mb-5">
                        <div id="check" class=" ftco-animate">

                            <h1> Description </h1>

                            <p class="flip"><span class="deg1"></span><span class="deg2"></span><span class="deg3"></span></p>
                            <p id="desc"><b>@Model.DealDesc</b></p>

                            <div class="crust row">
                                &nbsp; &nbsp; @Html.DropDownList("crust", listItems, "-- Select Crust --")

                            </div>

                           
                            <h4 id="price">Price : @Model.DealPrice  $</h4>
                            <h4>Quantity</h4> <input id="qty" min="1" value="1" style="text-align:center;" type="number" />

                            <div  class="checkboxes row">

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Banana Pepper Large" class="radio" value="7.99" name="fooby[1][]" />Banana Pepper
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Bihari Kabob Large" class="radio" value="3.00" name="fooby[2][]" />Bihari                                
                                </div>
                                
                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Black Olive Large" class="radio" value="7.99" name="fooby[3][]" />Black Olive
                                </div>
                                
                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Cheese Large" class="radio" value="7.99" name="fooby[4][]" />Cheese
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Chicken Tikka Large" class="radio" value="10.99" name="fooby[5][]" />Chicken Tikka
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Green Olive Large" class="radio" value="7.99" name="fooby[6][]" />Green Olive
                                </div>
                          
                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Green Pepper Large" class="radio" value="7.99" name="fooby[7][]" />Green Pepper
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Gyros Large" class="radio" value="10.99" name="fooby[8][]" />Gyros
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Jalapeno Large" class="radio" value="7.99" name="fooby[9][]" />Jalapeno
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Mushroom Large" class="radio" value="7.99" name="fooby[10][]" />Mushroom
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Onion Large" class="radio" value="7.99" name="fooby[11][]" />Onion
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Pepperoni Large" class="radio" value="9.99" name="fooby[12][]" />Pepperoni
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Pineapple Large" class="radio" value="7.99" name="fooby[13][]" />Pineapple
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" data-name="Sausage Large" class="radio" value="9.99" name="fooby[14][]" />Sausage
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" class="radio" data-name="Spinach Large" value="7.99" name="fooby[15][]" />Spinach
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" class="radio" data-name="Tomato Large" value="7.99" name="fooby[16][]" />Tomato
                                </div>

                                <div class="col-md-6 col-lg-4 col-xs-12 col-sm-6 ">
                                    <input type="checkbox" class="radio" data-name="Turkey Ham Large" value="9.99" name="fooby[17][]" />Turkey Ham
                                </div>

                            </div>


                            <h3 id="totalpice">Total Price : </h3>
                            <textarea name="" id="remarks" cols="30" rows="7" class="form-control" placeholder="Remarks ( optional )"></textarea>

                        </div>
                        <a id="sbmt" class="btn btn-white btn-outline-white mt-3 ftco-animate">ADD TO CART</a>
                    </div>
                    <div class="col-md-12 d-flex align-items-center">
                        <div class="tab-content ftco-animate" id="v-pills-tabContent">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<div id="modal1" class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <div style="overflow-x:auto;" class="ftco-animated">
                    <table id="mytable" class="table table-striped table-dark ft ftco-animate justify-content-center">

                        <thead class="ftco-animated">
                            <tr class="ftco-animated">
                                <th scope="col">Image</th>
                                <th scope="col">Name</th>
                                <th scope="col">Description</th>
                                <th scope="col">Quantity</th>
                                <th scope="col">Price</th>
                            </tr>
                        </thead>




                        <tbody class="ftco-animate"></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" onclick="location.href='@Url.Action("add_to_cart")'" class="btn btn-primary"> Cart Details  </button>
            </div>

        </div>
    </div>

</div>
<script src="~/Scripts/jquery-1.10.2.js"></script>
<script>

    $(document).ready(function () {

        var toppings = "";
        var id = parseInt($("#id").text());
  
        if ( id < 3 || id == 7 || id > 8 ) {

            if (id != 7) {
                $(".crust").remove();
            }
            $(".checkboxes").remove();
            
        }

        $("input:checkbox").on("change", function () {

            var selectedname = new Array();
            var $box = $(this);
            var i = 1;

            $("input[type=checkbox]:checked").each(function () {
                selectedname.push($(this).data("name"));
            });

            if (id == 3) {
                i = 2;
            }

            if (selectedname.length < i + 1) {
                toppings =  selectedname.join(",").toString();
            } else {
                alertify.message("you can select only " + i +" topping(s)");
                $(this).prop("checked", false);
            }
        });


        $("#sbmt").on("click", function () {

            var crust = $("#crust option:selected").text();


            debugger;
            var qty = $("#qty").val();
            var pricetext = $("#price").text();
            var price = parseFloat(pricetext.match(/-?(?:\d+(?:\.\d*)?|\.\d+)/)[0]);
            var pieces = $("#pieces").text();
            var itemname = $("#name").text();
            var img = $("#img").text();
            var remarks = $("#remarks").val();
            var desc ;

            if (id > 2 && id <9) {
    
                desc = "Crust Type : " + crust + " , ";
             //   toppings = toppings;

            }else{
                desc = $("#desc").text();
            }
            //var tooppings = $("toppings").text();

           
            if (crust != "-- Select Crust --") {
                $.ajax({
                    type: "POST",
                    url: "/Home/add_to_cart", //url to get list

                    data: { price: price, qty: qty, id: id, name: itemname, image: img, desc: desc, topping: "Topping(s) : " + toppings, crust: crust, remarks: remarks},
                    success: function (response) {

                        $mymodal = $("#modal1");
                        $mymodal.find("div.modal-body #mytable tbody").html(response);
                        $mymodal.modal("show");
                        //console.log(data);
                    },
                    error: function (error) {
                        console.log(error);
                    },
                    complete: function () {
                        // Handle the complete event
                        // $("#modal").modal("show");
                    }
                });
            } else {
                alertify.message("please Select Crust");
            }




        });


        $("#qty").on("change", function () {

            var qty = parseInt($("#qty").val());
            var pricetext = $("#price").text();
            var price = parseFloat(pricetext.match(/-?(?:\d+(?:\.\d*)?|\.\d+)/)[0]);



            $("#totalpice").text("Total Price : " + price.toFixed(2) * qty + "$");

        });



    });

</script>
